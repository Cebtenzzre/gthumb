%define release 8
%define prefix  /usr
%define name	@PACKAGE@
%define version @VERSION@

Summary:	An image viewer and browser for GNOME.
Name:		%{name}
Version:    	%{version}
Release:	%{release}
Copyright:	GPL
Vendor:		GNOME
URL:		http://gthumb.sourceforge.net/
Group:		Applications/Multimedia
Source0:	%{name}-%{version}.tar.gz
Packager:       Paolo Bacchilega <paolo.bacch@tin.it>	
BuildRoot:	%{_builddir}/%{name}-%{version}-root
Requires:	libpng
Requires:       glib2 >= @GLIB_REQUIRED@
Requires:       gtk2 >= @GTK_REQUIRED@
Requires:	libxml2 >= @LIBXML_REQUIRED@
Requires:	libgnome >= @LIBGNOME_REQUIRED@
Requires:	libgnomeui >= @LIBGNOMEUI_REQUIRED@
Requires:	gnome-vfs2 >= @GNOME_VFS_REQUIRED@
Requires:	libglade2 >= @LIBGLADE_REQUIRED@
Requires:	libgnomeprint >= @LIBGNOMEPRINT_REQUIRED@
Requires:	libgnomeprintui >= @LIBGNOMEPRINTUI_REQUIRED@
Requires:	bonobo-activation >= @BONOBO_ACTIVATION_REQUIRED@
Requires:	libbonobo >= @LIBBONOBO_REQUIRED@
Requires:	libbonoboui >= @LIBBONOBOUI_REQUIRED@
BuildRequires:	libpng-devel
BuildRequires:	glib2-devel >= @GLIB_REQUIRED@
BuildRequires:	gtk2-devel >= @GTK_REQUIRED@
BuildRequires:	libxml2-devel >= @LIBXML_REQUIRED@
BuildRequires:	libgnome-devel >= @LIBGNOME_REQUIRED@
BuildRequires:	libgnomeui-devel >= @LIBGNOMEUI_REQUIRED@
BuildRequires:	gnome-vfs2-devel >= @GNOME_VFS_REQUIRED@
BuildRequires:	libglade2-devel >= @LIBGLADE_REQUIRED@
BuildRequires:	libgnomeprint-devel >= @LIBGNOMEPRINT_REQUIRED@
BuildRequires:	libgnomeprintui-devel >= @LIBGNOMEPRINTUI_REQUIRED@
BuildRequires:	bonobo-activation-devel >= @BONOBO_ACTIVATION_REQUIRED@
BuildRequires:	libbonobo-devel >= @LIBBONOBO_REQUIRED@
BuildRequires:	libbonoboui-devel >= @LIBBONOBOUI_REQUIRED@
Docdir:         %{prefix}/share/doc

%description
gThumb lets you browse your hard disk, showing you thumbnails of image files. 
It also lets you view single files (including GIF animations), add comments to
images, organize images in catalogs, print images, view slideshows, set your
desktop background, and more. 

%prep
%setup 

%build
%configure --disable-schemas-install
make

%install
rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT install

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%{_bindir}/gthumb
%{_libexecdir}/gthumb-image-viewer
%{_libexecdir}/gthumb-catalog-view
%{_datadir}/applications/gthumb.desktop
%{_datadir}/gnome-2.0/ui/*.xml
%{_datadir}/gthumb/glade/*.glade
%{_datadir}/gthumb/icons/*
%{_datadir}/gthumb/albumthemes/*
%{_datadir}/locale/*/LC_MESSAGES/gthumb.mo
%{_datadir}/application-registry/gthumb.applications
%{_libdir}/bonobo/servers/*.server
%{_libdir}/gthumb/modules/*
%{_datadir}/pixmaps/gthumb.png
%{_sysconfdir}/gconf/schemas/*.schemas
%doc AUTHORS NEWS README COPYING
%doc %{_datadir}/man/man1/gthumb.1*
%doc %{_datadir}/gnome/help/gthumb

%post
GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source` gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/gthumb.schemas
if which scrollkeeper-update>/dev/null 2>&1; then scrollkeeper-update; fi

%postun
if which scrollkeeper-update>/dev/null 2>&1; then scrollkeeper-update; fi
